**特征值**：x,y坐标，定位准确性，时间

**目标值**：入住位置的id

**处理**：

1.缩小数据集范围

`DataFrame.query('condition')`

2.处理日期数据

`pd.to_datetime`

`pd.Datetimeindex`

3.增加分割的日期数据

4.删除没用的日期数据

`DataFrame.drop`

5.将签到位置少于n个用户的删除

`place_count=data.groupby('place_id').count()`

`tf=place_count[place_count.row_id>3].reset_index()`

`data = data[data['place_id'].isin(tf.place_id)]`

**两张表的字段**：

`test.csv(row_id,x,y,accuracy,time)`;

`train.csv(row_id,x,y,accuracy,time,place_id)`.

**用`train.csv`抽取部分数据做的预测模型**：

代码：

```python
from sklearn.neighbors import KNeighborsClassifier
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
import pandas as pd
def knn_cls():
    """
    K近邻预测用户签到位置
    :return: None
    """
    #读取数据
    data=pd.read_csv('./datasets/train.csv')
    #处理数据
    #1.筛选数据以缩小数据范围
    data=data.query('x>1.0 & x<1.25 & y>2.5 & y<2.75')
    #2.处理时间数据
    time_value=pd.to_datetime(data['time'], unit='s')
    #将日期格式转换成字典格式
    time_value=pd.DatetimeIndex(time_value)
    #构造一些特征
    data['day']=time_value.day
    data['hour'] = time_value.hour
    data['weekday']=time_value.weekday
    #把时间戳特征删除(1表示列，0表示行)
    data.drop(['time'],axis=1)
    #3.把签到数量少于n个目标位置删除
    # 按place_id进行分组
    place_count = data.groupby('place_id').count()
    #删除次数少于n的位置并重置索引
    tf = place_count[place_count.row_id > 3].reset_index()
    #筛选data中符合条件的样本
    data = data[data['place_id'].isin(tf.place_id)]
    #取出数据当中的特征值和目标值
    y=data['place_id']
    x=data.drop(['place_id'],axis=1).drop(['row_id'],axis=1)
    #进行数据集的分割
    x_train, x_test, y_train, y_test = train_test_split(x,y, test_size=0.25)
    #特征工程(标准化）
    std=StandardScaler()
    #对训练集和特征集进行标准化处理
    x_train=std.fit_transform(x_train)
    x_test=std.fit_transform(x_test)
    #进行算法流程
    #1.实例化
    knn=KNeighborsClassifier(n_neighbors=5)
    #2.传入训练数据
    knn.fit(x_train,y_train)
    #3.传入测试集进行预测
    y_predict=knn.predict(x_test)
    #4.打印预测值
    print("预测的目标签到位置:",'\n',y_predict)
    #5.打印准确率
    print("预测的准确率:",'\n',knn.score(x_test,y_test))
    return None
if __name__ == '__main__':
    knn_cls()
```

运行结果：

```python
预测的目标签到位置: 
 [5009192468 5606572086 1435128522 ... 3312463746 4932578245 7162308755]
预测的准确率: 
 0.4718676122931442
```

