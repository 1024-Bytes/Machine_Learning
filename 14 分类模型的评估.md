# 分类模型评估的标准

## 标准一：准确率

`estimator.score()`

一般最常用的是准确率，即预测结果正确的百分比

## 混淆矩阵

在分类任务下，预测结果与正确标记之间存在四种不同的组合，构成混淆矩阵(适用于多分类)

|          |      | 预测                       | 结果                       |
| :------: | ---: | :------------------------- | -------------------------- |
|          |      | 正例                       | 假例                       |
| **真实** | 正例 | 真正例`TP(true positive)`  | 伪反例`FN(false negative)` |
| **结果** | 假例 | 伪正例`FP(false positive)` | 真反例`TN(true negative)`  |

**注**：对于每一个类别都会有一个混淆矩阵

## 标准二：精确率(Precision)

精确率为正例样本中真实为正例的比例(查得准)

精确率=`TP/(TP+FP)`或真正例/(真正例+伪正例)

## 标准三：召回率(Recall)

真实为正例的样本中预测结果为正例的比例(查得全，对正样本的区分能力)

召回率=`TP/(TP+FN)`或真正例/(真正例+伪反例)

## 其他分类标准

### `F1-score`

反映了模型的稳健型

`F1=2TP/(2TP+FN+FP)=2 x Precision x Recall/(Precision+Recall)`

# 分类模型评估`API`

`sklearn.metrics.classification_report`

## 语法

`sklearn.metrics.classification_report(y_true,y_pred,target_names=None)`

`y_true`:真实目标值

`y_pred`:估计器预测目标值

`target_names`:目标类别名称

`return`:每个类别精确率与召回率

# 分类模型评估应用代码示例

代码：

```python
from sklearn.naive_bayes import MultinomialNB
from sklearn.datasets import fetch_20newsgroups
from sklearn.model_selection import train_test_split
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.metrics import classification_report
def naviebayes():
    """
    朴素贝叶斯进行文本分类
    :return:None
    """
    # 加载新闻数据集
    news = fetch_20newsgroups(subset='all')
    # 进行数据分割
    x_train, x_test, y_train, y_test = train_test_split(news.data, news.target, test_size=0.25)
    # 对数据集进行特征抽取
    tf = TfidfVectorizer()
    # 以训练集当中的词的列表进行每篇文章重要性统计
    x_train = tf.fit_transform(x_train)
    x_test = tf.transform(x_test)
    # 进行朴素贝叶斯算法的预测
    mlt = MultinomialNB(alpha=1.0)
    mlt.fit(x_train, y_train)
    y_predict = mlt.predict(x_test)
    print('预测结果:', '\n', y_predict)
    print('准确率为:', '\n', mlt.score(x_test, y_test))
    print('每个类别的精确率和召回率:','\n',classification_report(y_test, y_predict, target_names=news.target_names))
    return None
if  __name__ == "__main__":
     naviebayes()
```

运行结果：

```python
预测结果: 
 [ 3  0  2 ... 11 16  9]
准确率为: 
 0.841044142614601
每个类别的精确率和召回率: 
                           precision    recall  f1-score   support

             alt.atheism       0.87      0.76      0.81       189
           comp.graphics       0.83      0.78      0.81       227
 comp.os.ms-windows.misc       0.87      0.82      0.84       255
comp.sys.ibm.pc.hardware       0.68      0.85      0.76       238
   comp.sys.mac.hardware       0.94      0.85      0.89       248
          comp.windows.x       0.95      0.81      0.87       262
            misc.forsale       0.94      0.65      0.77       276
               rec.autos       0.85      0.91      0.88       247
         rec.motorcycles       0.94      0.96      0.95       248
      rec.sport.baseball       0.94      0.97      0.95       226
        rec.sport.hockey       0.92      0.98      0.95       243
               sci.crypt       0.81      0.98      0.89       267
         sci.electronics       0.91      0.74      0.81       268
                 sci.med       0.96      0.91      0.93       248
               sci.space       0.86      0.97      0.91       230
  soc.religion.christian       0.51      0.99      0.67       231
      talk.politics.guns       0.77      0.97      0.86       231
   talk.politics.mideast       0.90      0.97      0.93       226
      talk.politics.misc       0.99      0.59      0.74       183
      talk.religion.misc       1.00      0.13      0.23       169

                accuracy                           0.84      4712
               macro avg       0.87      0.83      0.82      4712
            weighted avg       0.87      0.84      0.83      4712

```

